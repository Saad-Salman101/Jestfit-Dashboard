import{x as H,y as L,j as e,r as j,u as M,a as U,b as V,F as G,c as A,d as P,z as w,e as J,E as Y,f as D,B as g,g as K,h as l,G as $,T as f,A as W,l as q,i as c,I as u,O as p,k as y,D as Q,H as X,m as Z,J as ee}from"./index-DLcGPbaO.js";var k={},re=L;Object.defineProperty(k,"__esModule",{value:!0});var _=k.default=void 0,te=re(H()),se=e;_=k.default=(0,te.default)((0,se.jsx)("path",{d:"M18 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m-2.5 4c0-1.38 1.12-2.5 2.5-2.5.42 0 .8.11 1.15.29l-3.36 3.36c-.18-.35-.29-.73-.29-1.15m2.5 2.5c-.42 0-.8-.11-1.15-.29l3.36-3.36c.18.35.29.73.29 1.15 0 1.38-1.12 2.5-2.5 2.5M17 18H7V6h10v1h2V3c0-1.1-.9-2-2-2H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-4h-2z"}),"AppBlocking");const ne=()=>{const[o,S]=j.useState(null),[C,B]=j.useState([]),[F,E]=j.useState(!0),N=M(),O=U(),{id:m}=N.state||{},d=V();j.useEffect(()=>{(async()=>{try{const t=await D.get(`/field/${m}`);S(t.data.result)}catch(t){console.error("Error fetching field data:",t),g.error("Failed to fetch field data!")}})()},[m,F]);const R=async r=>{try{const t=await D.delete(`/field/image/${m}/`,{params:{link:r}});g.success("Image deleted successfully!"),S(t.data.result),E(!F)}catch(t){console.error("Image delete failed:",t),g.error("Failed to delete image!")}},T=r=>{B(r)};return o?e.jsx(G,{initialValues:{name:o.name,description:o.description,price:o.price,discount:o.priceDiscount,slots:o.slots||[]},validationSchema:A({name:P().required("Name is required"),description:P().required("Description is required"),price:w().required("Price is required"),discount:w().required("Discount is required"),slots:J().of(A({price:w().required("Price is required"),isEnabled:Y().required()})).required("Slots are required")}),onSubmit:async(r,{setSubmitting:t})=>{t(!0);try{const s=new FormData;s.append("name",r.name),s.append("description",r.description),s.append("price",r.price),s.append("priceDiscount",r.discount),s.append("slots",JSON.stringify(r.slots)),C.forEach(b=>s.append("images",b)),await D.put(`/field/${m}`,s,{headers:{"Content-Type":"multipart/form-data"}}),g.success("Field updated successfully!"),B([]),E(!F)}catch(s){console.error("Update failed:",s),g.error("Failed to update field!")}t(!1)},children:({values:r,handleChange:t,handleBlur:s,handleSubmit:b,setFieldValue:z,isSubmitting:ie,touched:n,errors:i})=>e.jsx(K,{onSubmit:b,children:e.jsxs(l,{children:[e.jsxs($,{container:!0,justifyContent:"space-between",width:"100%",children:[e.jsx($,{item:!0,children:e.jsx(f,{variant:"h3",mb:2,children:"Update Your Field:"})}),e.jsx($,{item:!0,children:e.jsx(l,{display:"flex",alignItems:"center",children:e.jsx(W,{children:e.jsxs(q,{fullWidth:!0,size:"small",onClick:()=>{O(`/disableSlot/${m}`)},variant:"contained",color:"secondary",children:["Disable Slots on daily basis",e.jsx(_,{color:"primary"})]})})})})]}),e.jsxs(c,{fullWidth:!0,error:!!(n.name&&i.name),sx:{...d.typography.customInput},children:[e.jsx(u,{htmlFor:"outlined-adornment-name-register",children:"Field Name "}),e.jsx(p,{id:"outlined-adornment-name-register",value:r.name,name:"name",onBlur:s,onChange:t}),n.name&&i.name&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:i.name})]}),e.jsxs(c,{fullWidth:!0,error:!!(n.description&&i.description),sx:{...d.typography.customInput},children:[e.jsxs(u,{htmlFor:"outlined-adornment-address-register",children:[" ","Description"," "]}),e.jsx(p,{id:"outlined-adornment-address-register",value:r.description,name:"description",onBlur:s,onChange:t}),n.description&&i.description&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:i.description})]}),e.jsxs(c,{fullWidth:!0,error:!!(n.price&&i.price),sx:{...d.typography.customInput},children:[e.jsx(u,{htmlFor:"outlined-adornment-block-register",children:"Price "}),e.jsx(p,{id:"outlined-adornment-block-register",value:r.price,name:"price",onBlur:s,onChange:t}),n.price&&i.price&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:i.price})]}),e.jsxs(c,{fullWidth:!0,error:!!(n.discount&&i.discount),sx:{...d.typography.customInput},children:[e.jsxs(u,{htmlFor:"outlined-adornment-city-register",children:["Discount (In Percentage)"," "]}),e.jsx(p,{id:"outlined-adornment-discount-register",value:r.discount,name:"discount",onBlur:s,onChange:t}),n.discount&&i.discount&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:i.city})]}),e.jsx(f,{variant:"h6",mt:4,children:"Current Images"}),e.jsx(l,{display:"flex",flexWrap:"wrap",gap:2,mt:2,children:o.images.map((h,x)=>e.jsxs(l,{sx:{position:"relative"},children:[e.jsx("img",{src:h.uri,alt:`Field ${x+1}`,style:{width:"150px",height:"150px",borderRadius:"8px"}}),e.jsx(q,{variant:"contained",color:"error",size:"small",sx:{position:"absolute",top:"8px",right:"8px",minWidth:"unset"},onClick:()=>R(h.uri),children:"Ã—"})]},x))}),e.jsx(f,{variant:"h6",mt:4,children:"Add New Images"}),e.jsx(Q,{setFieldValue:(h,x)=>{h==="images"&&T(x)},values:{images:C}}),e.jsx(f,{variant:"h6",mt:4,children:"Manage Slots"}),e.jsx(X,{name:"slots",children:({push:h,remove:x})=>e.jsx(l,{children:r.slots.map((v,a)=>e.jsxs(l,{display:"flex",alignItems:"center",gap:1,sx:{borderRadius:2},children:[e.jsxs(c,{sx:{...d.typography.customInput},children:[e.jsx(u,{shrink:!0,htmlFor:`slots[${a}].to`,children:"To"}),e.jsx(p,{id:`slots[${a}].to`,value:v.to,disabled:!0,margin:"dense"})]}),e.jsxs(c,{sx:{...d.typography.customInput},children:[e.jsx(u,{shrink:!0,htmlFor:`slots[${a}].from`,children:"From"}),e.jsx(p,{id:`slots[${a}].from`,value:v.from,disabled:!0,margin:"dense"})]}),e.jsxs(c,{sx:{...d.typography.customInput},children:[e.jsx(u,{shrink:!0,htmlFor:`slots[${a}].price`,children:"Price"}),e.jsx(p,{name:`slots[${a}].price`,label:"Price",type:"number",value:r.slots[a].price,onChange:I=>z(`slots[${a}].price`,I.target.value),onBlur:s,margin:"normal",sx:{width:120}})]}),e.jsx(Z,{control:e.jsx(ee,{checked:r.slots[a].isEnabled,onChange:I=>z(`slots[${a}].isEnabled`,I.target.checked)}),label:"Enabled"})]},v._id))})}),e.jsx(l,{sx:{mt:2},width:"95px",children:e.jsx(W,{children:e.jsx(q,{size:"large",type:"submit",variant:"contained",color:"secondary",children:"Update"})})})]})})}):e.jsx("div",{children:"Loading..."})};export{ne as default};
