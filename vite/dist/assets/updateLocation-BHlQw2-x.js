import{r as y,u as N,a as O,b as E,j as e,F as U,c as z,d as l,e as A,f as k,B as d,g as M,h as p,G as D,T as L,i as u,I as m,O as j,k as h,S as V,M as G,l as q,D as R,A as H}from"./index-DLcGPbaO.js";const K=()=>{const[r,F]=y.useState(null),[I,w]=y.useState([]),C=["cricket","tennis","swimming","pool"],[f,B]=y.useState(!0),S=N();O();const{id:x}=S.state||{},c=E();y.useEffect(()=>{(async()=>{try{const a=await k.get(`/location/${x}`);console.log(a.data.result.tags),F(a.data.result)}catch(a){console.error("Error fetching location data:",a),d.error("Failed to fetch location data!")}})()},[x,f]);const v=t=>{w(t)},T=async t=>{try{const a=await k.delete(`/location/image/${x}/`,{params:{link:t}});d.success("Image deleted successfully!"),F(a.data.result),B(!f)}catch(a){console.error("Image delete failed:",a),d.error("Failed to delete image!")}};return r?e.jsx(U,{initialValues:{name:r.name,description:r.description,block:r.block||"",city:r.city||"",tags:r.tags||[],images:[]},validationSchema:z({name:l().required("Name is required"),description:l().required("Description is required"),block:l().required("Block is required"),city:l().required("City is required"),tags:A().of(l()).required("Tags are required")}),onSubmit:async(t,{setSubmitting:a})=>{a(!0);try{const s=new FormData;s.append("name",t.name),s.append("description",t.description),s.append("block",t.block),s.append("city",t.city),s.append("tags",JSON.stringify(t.tags)),I.forEach(b=>s.append("images",b)),await k.put(`/location/${x}`,s,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Location updated successfully!"),B(!f),w([])}catch(s){console.error("Update failed:",s),d.error("Failed to update location!")}a(!1)},children:({values:t,handleChange:a,handleBlur:s,handleSubmit:b,setFieldValue:W,isSubmitting:$,touched:o,errors:i})=>e.jsx(M,{onSubmit:b,children:e.jsxs(p,{children:[e.jsx(D,{container:!0,justifyContent:"space-between",width:"100%",children:e.jsx(D,{item:!0,children:e.jsx(L,{variant:"h3",mb:2,children:"Update Location:"})})}),e.jsxs(u,{fullWidth:!0,error:!!(o.name&&i.name),sx:{...c.typography.customInput},children:[e.jsx(m,{htmlFor:"name",children:"Location Name"}),e.jsx(j,{id:"name",name:"name",value:t.name,onChange:a,onBlur:s}),o.name&&i.name&&e.jsx(h,{children:i.name})]}),e.jsxs(u,{fullWidth:!0,error:!!(o.description&&i.description),sx:{...c.typography.customInput},children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(j,{id:"description",name:"description",value:t.description,onChange:a,onBlur:s,rows:3}),o.description&&i.description&&e.jsx(h,{children:i.description})]}),e.jsxs(u,{fullWidth:!0,error:!!(o.block&&i.block),sx:{...c.typography.customInput},children:[e.jsx(m,{htmlFor:"block",children:"Block"}),e.jsx(j,{id:"block",name:"block",value:t.block,onChange:a,onBlur:s}),o.block&&i.block&&e.jsx(h,{children:i.block})]}),e.jsxs(u,{fullWidth:!0,error:!!(o.city&&i.city),sx:{...c.typography.customInput},children:[e.jsx(m,{htmlFor:"city",children:"City"}),e.jsx(j,{id:"city",name:"city",value:t.city,onChange:a,onBlur:s}),o.city&&i.city&&e.jsx(h,{children:i.city})]}),e.jsxs(u,{fullWidth:!0,error:!!(o.tags&&i.tags),sx:{...c.typography.customMultiSelect},children:[e.jsx(m,{id:"tags-label",children:"Tags"}),e.jsx(V,{labelId:"tags-label",id:"tags",multiple:!0,value:t.tags,onChange:n=>W("tags",n.target.value),renderValue:n=>n.join(", "),children:C.map(n=>e.jsx(G,{value:n,children:n},n))}),o.tags&&i.tags&&e.jsx(h,{children:i.tags})]}),e.jsx(p,{display:"flex",flexWrap:"wrap",gap:2,mt:2,children:r.images.map((n,g)=>e.jsxs(p,{sx:{position:"relative"},children:[e.jsx("img",{src:n.uri,alt:`Field ${g+1}`,style:{width:"150px",height:"150px",borderRadius:"8px"}}),e.jsx(q,{variant:"contained",color:"error",size:"small",sx:{position:"absolute",top:"8px",right:"8px",minWidth:"unset"},onClick:()=>T(n.uri),children:"Ã—"})]},g))}),e.jsxs(p,{mt:2,children:[e.jsx(L,{variant:"subtitle1",children:"Upload New Images"}),e.jsx(R,{setFieldValue:(n,g)=>{n==="images"&&v(g)},values:{images:I}})]}),e.jsx(p,{mt:2,children:e.jsx(H,{children:e.jsx(q,{type:"submit",variant:"contained",color:"secondary",disabled:$,children:"Update Location"})})})]})})}):e.jsx("div",{children:"Loading..."})};export{K as default};
