import{c as V,d as x,z as C,K as J,r as j,a as R,b as K,j as e,F as Q,B as T,f as I,g as U,h as W,G as B,i as a,I as c,O as h,k as y,S as b,M as S,T as X,H as Y,V as v,W as F,m as Z,J as _,D as ee,l as te}from"./index-DLcGPbaO.js";const re=V({name:x().required("Name is required"),description:x().required("Description is required"),sportTypeID:x().required("Sport Type is required"),locationID:x().required("Location ID is required"),vendorID:x().required("Vendor ID is required"),price:C().integer("price must be a full number").required("price is required"),discount:C().integer("base discount must be a full number").required("base discount is required")}),ne=()=>{var $;const u=J(t=>t.user.userDetail),[E,L]=j.useState([]),[k,M]=j.useState([]),[w,N]=j.useState(""),[D,O]=j.useState([]),H=R(),P=(t,l,r,d)=>{const f=[];let o=new Date;o.setHours(t,0,0,0);const n=new Date;for(n.setHours(l,0,0,0);o<n;){const m=new Date(o);o.setMinutes(o.getMinutes()+r);const s=new Date(o);f.push({to:m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),from:s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),price:d,isEnabled:!0})}return f},z={name:null,description:null,price:null,discount:null,vendorID:u.role==="vendor"?($=u==null?void 0:u.vendorID)==null?void 0:$.id:"",locationID:"",sportTypeID:D.length!==0?D[0].id:null,slots:P(0,24,30,2e3),images:[]},A=async()=>{const t=await I.get("/vendor",{params:{limit:100}});console.log(t.data.result.results,"<== =vendorrrr"),M(t.data.result.results);const l=await I.get("/location",{params:{vendorID:u.role==="vendor"?u.vendorID.id:w}}),r=await I.get("/sportType");O(r.data.result.results),L(l.data.result.results)};j.useEffect(()=>{A()},[w]);const p=K();return e.jsx(Q,{initialValues:z,validationSchema:re,onSubmit:async(t,{setSubmitting:l})=>{if(l(!0),t.images.length===0){T.error("At least One Image Is Required For The Field"),l(!1);return}console.log(t,"<==== values ");const r=new FormData;r.append("name",t.name),r.append("description",t.description),r.append("sportTypeID",t.sportTypeID),r.append("price",t.price),r.append("vendorID",t.vendorID),r.append("priceDiscount",t.discount),r.append("locationID",t.locationID),r.append("slots",JSON.stringify(t.slots));for(let d=0;d<t.images.length;d++)r.append("images",t.images[d]);try{const d=await I.post("/field",r,{headers:{"Content-Type":"multipart/form-data"}});console.log(d,"<==== response"),T.success("Successfully Created!"),H("/field")}catch(d){console.error(d,"<==== error"),T.error("Submission failed!")}l(!1)},children:({values:t,handleChange:l,handleBlur:r,handleSubmit:d,isSubmitting:f,touched:o,errors:n,setFieldValue:m})=>e.jsx(U,{onSubmit:d,children:e.jsx(W,{sx:{flexGrow:1,p:2},children:e.jsxs(B,{container:!0,spacing:2,children:[e.jsxs(a,{fullWidth:!0,error:!!(o.name&&n.name),sx:{...p.typography.customInput},children:[e.jsx(c,{htmlFor:"outlined-adornment-name-register",children:"Field Name "}),e.jsx(h,{id:"outlined-adornment-name-register",value:t.name,name:"name",onBlur:r,onChange:l}),o.name&&n.name&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:n.name})]}),e.jsxs(a,{fullWidth:!0,error:!!(o.description&&n.description),sx:{...p.typography.customInput},children:[e.jsxs(c,{htmlFor:"outlined-adornment-address-register",children:[" ","Description"," "]}),e.jsx(h,{id:"outlined-adornment-address-register",value:t.description,name:"description",onBlur:r,onChange:l}),o.description&&n.description&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:n.description})]}),e.jsxs(a,{fullWidth:!0,sx:{...p.typography.customSelect},children:[e.jsx(c,{id:"sportTypeID",children:"Sport Type"}),e.jsx(b,{labelId:"tags-sportType",id:"sportTypeID",value:t.sportTypeID,onChange:s=>m("sportTypeID",s.target.value),children:D.map((s,g)=>e.jsx(S,{value:s.id,children:s.name},g))}),o.sportType&&n.sportType&&e.jsx(y,{error:!0,id:"sportTypeID",children:n.sportType})]}),e.jsxs(a,{fullWidth:!0,error:!!(o.price&&n.price),sx:{...p.typography.customInput},children:[e.jsx(c,{htmlFor:"outlined-adornment-block-register",children:"Price "}),e.jsx(h,{id:"outlined-adornment-block-register",value:t.price,name:"price",onBlur:r,onChange:l}),o.price&&n.price&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:n.price})]}),e.jsxs(a,{fullWidth:!0,error:!!(o.discount&&n.discount),sx:{...p.typography.customInput},children:[e.jsxs(c,{htmlFor:"outlined-adornment-city-register",children:["Discount (In Percentage)"," "]}),e.jsx(h,{id:"outlined-adornment-discount-register",value:t.discount,name:"discount",onBlur:r,onChange:l}),o.discount&&n.discount&&e.jsx(y,{error:!0,id:"standard-weight-helper-text--register",children:n.city})]}),u.role==="admin"?e.jsxs(a,{fullWidth:!0,sx:{...p.typography.customSelect},children:[e.jsx(c,{id:"tags-label",children:"Vendor"}),e.jsx(b,{labelId:"vendor-ID",id:"vendorID",value:t.id,onChange:s=>{m("vendorID",s.target.value),N(s.target.value)},children:k.map((s,g)=>e.jsx(S,{value:s.id,children:s.companyName},g))})]}):null,e.jsxs(a,{fullWidth:!0,sx:{...p.typography.customSelect},children:[e.jsx(c,{id:"location-ID",children:"Location"}),e.jsx(b,{labelId:"location-ID",id:"locationID",value:t.id,onChange:s=>m("locationID",s.target.value),children:E.map((s,g)=>e.jsx(S,{value:s.id,children:s.name},g))})]}),e.jsxs(a,{fullWidth:!0,sx:{justifyContent:"center",alignItems:"center",width:"100%"},children:[e.jsx(X,{variant:"h3",sx:{...p.typography.customInput},children:"Slots"}),e.jsx(Y,{name:"slots",children:({push:s,remove:g})=>e.jsx("div",{children:t.slots.map((q,i)=>e.jsxs(W,{mb:2,gap:1,display:"flex",alignItems:"center",children:[e.jsxs(a,{children:[e.jsx(c,{htmlFor:`slots[${i}].to`,children:"To"}),e.jsx(v,{id:`slots[${i}].to`,as:h,name:`slots[${i}].to`,label:"To",variant:"outlined",margin:"normal",disabled:!0}),e.jsx(F,{name:`slots[${i}].to`,component:"div"})]}),e.jsxs(a,{children:[e.jsx(c,{htmlFor:`slots[${i}].from`,children:"From"}),e.jsx(v,{id:`slots[${i}].from`,as:h,name:`slots[${i}].from`,label:"From",variant:"outlined",margin:"normal",disabled:!0}),e.jsx(F,{name:`slots[${i}].from`,component:"div"})]}),e.jsxs(a,{children:[e.jsx(c,{htmlFor:`slots[${i}].price`,children:"Price"}),e.jsx(v,{id:`slots[${i}].price`,as:h,name:`slots[${i}].price`,label:"Price",variant:"outlined",margin:"normal"}),e.jsx(F,{name:`slots[${i}].price`,component:"div"})]}),e.jsx(a,{children:e.jsx(Z,{control:e.jsx(_,{checked:q.isEnabled,onChange:G=>m(`slots[${i}].isEnabled`,G.target.checked),color:"primary"}),label:q.isEnabled?"Slot Open":"Slot Closed"})})]},i))})})]}),e.jsx(a,{fullWidth:!0,sx:{mt:2},children:e.jsx(ee,{setFieldValue:m,values:t})}),e.jsx(B,{item:!0,xs:12,children:e.jsx(te,{type:"submit",size:"large",variant:"contained",color:"secondary",children:"Create Field"})})]})})})})};export{ne as default};
